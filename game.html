<!-- author: sjxxxx -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <title>游戏中 - 鲜椒本科模拟器</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/mobile_v2.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- 主游戏界面 -->
    <div id="game-screen" class="screen active">
        <!-- 顶部状态栏 -->
        <header class="game-header">
            <div class="time-info">
                <span id="current-year">大一</span>
                <span id="current-month">9月</span>
                <span id="current-semester">秋季学期</span>
            </div>
            <div class="location-info">
                <span id="current-location">兴庆校区</span>
            </div>
            <button id="btn-menu" class="btn-icon">☰</button>
        </header>

        <!-- 移动端顶部状态条 (移除，合并到下方) -->
        <!-- <div class="mobile-compact-header mobile-only-flex"> REMOVED </div> -->

        <!-- 游戏内容容器 (扁平化结构，移除Tabs) -->
        <!-- 移动端：上方反馈区域 -->
        <div id="mobile-top-section" class="mobile-only-block" style="margin-top: 10px;">
            <!-- 移动端动态反馈卡片 (合并版) -->
            <div class="mobile-status-card">
                <!-- 第一行：核心资源 (体力/SAN/金钱) -->
                <div class="m-card-row resource-row">
                    <div class="m-stat-compact">
                         <span class="label">体力</span>
                         <span class="value" id="m-val-energy">10/10</span>
                    </div>
                    <div class="m-stat-compact">
                         <span class="label">SAN值</span>
                         <span class="value" id="m-val-san">80</span>
                    </div>
                    <div class="m-stat-compact">
                         <span class="label">金币</span>
                         <span class="value" id="m-val-money">1000</span>
                    </div>
                </div>
                <!-- 第二行：长期属性 (GPA/综测/声望) -->
                <div class="m-card-row attribute-row">
                    <div class="m-stat-compact">
                        <span class="label">GPA</span>
                        <span class="value" id="m-val-gpa">3.00</span>
                    </div>
                    <div class="m-stat-compact">
                        <span class="label">综测</span>
                        <span class="value" id="m-val-social">60</span>
                    </div>
                    <div class="m-stat-compact">
                        <span class="label">声望</span>
                        <span class="value" id="m-val-reputation">50</span>
                        <button class="reputation-info-btn" title="声望增加方式" onclick="window.game?.showReputationInfo?.()">❓</button>
                    </div>
                </div>
                <!-- 日志预览 -->
                <div class="m-log-preview" id="mobile-log-preview">
                    <span class="m-log-icon">📢</span>
                    <span id="m-log-text">欢迎来到鲜椒！</span>
                </div>
                <!-- 移动端BBS滚动条 -->
                <div class="m-bbs-ticker mobile-only-block">
                    <div class="bbs-label">📢 交大BBS</div>
                    <div class="bbs-scroll" id="bbs-scroll-mobile">
                        <span class="bbs-item">欢迎来到鲜椒！</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- BBS舆论滚动条（桌面版） -->
        <div class="bbs-ticker desktop-only" id="bbs-ticker">
            <div class="bbs-label">📢 交大BBS</div>
            <div class="bbs-scroll" id="bbs-scroll">
                <span class="bbs-item">欢迎来到鲜椒！</span>
            </div>
        </div>

        <!-- 属性面板 -->
        <div class="stats-panel desktop-only">
            <div class="stat-item">
                <div class="stat-label">GPA</div>
                <div class="stat-value" id="stat-gpa">3.00/4.3</div>
                <div class="stat-bar">
                    <div class="stat-fill gpa" id="bar-gpa" style="width: 70%"></div>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">SAN值</div>
                <div class="stat-value" id="stat-san">80/100</div>
                <div class="stat-bar">
                    <div class="stat-fill san" id="bar-san" style="width: 80%"></div>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">体力</div>
                <div class="stat-value" id="stat-energy">10/10</div>
                <div class="stat-bar">
                    <div class="stat-fill energy" id="bar-energy" style="width: 100%"></div>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">综测</div>
                <div class="stat-value" id="stat-social">60</div>
                <div class="stat-bar">
                    <div class="stat-fill social" id="bar-social" style="width: 60%"></div>
                </div>
            </div>
             <div class="stat-item reputation-item" title="点击查看声望增加方式" onclick="window.game?.showReputationInfo?.()">
                <div class="stat-label">声望</div>
                <div class="stat-value" id="stat-reputation">⭐ 50</div>
                <div class="stat-bar">
                    <div class="stat-fill reputation" id="bar-reputation" style="width: 50%"></div>
                </div>
            </div>
            <div class="stat-item">
                <div class="stat-label">金币</div>
                <div class="stat-value" id="stat-money">💰 1000</div>
            </div>
        </div>

        <!-- 课程掌握度面板 -->
        <div class="course-panel" id="course-panel">
            <div class="panel-header-mobile-toggle">
                <h3>📖 当前课程</h3>
                <button class="btn-text" id="btn-toggle-courses">▼</button>
            </div>
            <div class="course-list" id="course-list">
                <!-- 动态生成 -->
            </div>
        </div>
        
        <!-- 长远规划面板（大三下开启） -->
        <div class="career-panel" id="career-panel" style="display: none;">
            <h3>🎯 长远规划</h3>
            <div class="career-info" id="career-info">
                <span class="career-path">未选择方向</span>
            </div>
            <div class="career-progress" id="career-progress"></div>
        </div>

        <!-- 移动端：行动分类过滤器 -->
        <div class="mobile-action-filter mobile-only-flex">
            <button class="filter-btn active" data-filter="all">🌟 全部</button>
            <button class="filter-btn" data-filter="study">📚 学习</button>
            <button class="filter-btn" data-filter="life">☕ 生活</button>
            <button class="filter-btn" data-filter="social">🤝 发展</button>
        </div>

        <!-- 行动区域 -->
        <div class="action-panel">
            <h3 class="desktop-only">选择行动</h3>
            <div class="action-grid" id="action-grid">
                <button class="action-btn study" data-action="attend-class">
                    <span class="action-icon">📚</span>
                    <span class="action-name">去上课</span>
                    <span class="action-cost">体力 -2</span>
                </button>
                <button class="action-btn study" data-action="self-study">
                    <span class="action-icon">📖</span>
                    <span class="action-name">去自习</span>
                    <span class="action-cost">体力 -3, SAN -2</span>
                </button>
                <button class="action-btn life" data-action="run" id="btn-run">
                    <span class="action-icon">🏃</span>
                    <span class="action-name">操场跑步</span>
                    <span class="action-cost">体力 -1, 体力上限+</span>
                </button>
                <button class="action-btn social" data-action="club">
                    <span class="action-icon">🎭</span>
                    <span class="action-name">搞社团</span>
                    <span class="action-cost">体力 -2, SAN +3</span>
                </button>
                <button class="action-btn social" data-action="volunteer">
                    <span class="action-icon">🤝</span>
                    <span class="action-name">做志愿</span>
                    <span class="action-cost">体力 -2</span>
                </button>
                <button class="action-btn study" data-action="parttime">
                    <span class="action-icon">💼</span>
                    <span class="action-name">去兼职</span>
                    <span class="action-cost">体力 -3, 金币 +100~200</span>
                </button>
                <button class="action-btn study" data-action="competition">
                    <span class="action-icon">🏆</span>
                    <span class="action-name">参加竞赛</span>
                    <span class="action-cost">体力 -4, SAN -5</span>
                </button>
                <button class="action-btn study" data-action="research">
                    <span class="action-icon">🔬</span>
                    <span class="action-name">科研实习</span>
                    <span class="action-cost">体力 -3, SAN -3</span>
                </button>
                <button class="action-btn study special" data-action="career" id="btn-career" style="display: none;">
                    <span class="action-icon">🎯</span>
                    <span class="action-name">长远规划</span>
                    <span class="action-cost">规划未来方向</span>
                </button>
                <button class="action-btn life" data-action="eat">
                    <span class="action-icon">🍱</span>
                    <span class="action-name">改善伙食</span>
                    <span class="action-cost">金币 -80, SAN +??</span>
                </button>
                <button class="action-btn life" data-action="entertainment">
                    <span class="action-icon">🎮</span>
                    <span class="action-name">娱乐放松</span>
                    <span class="action-cost">金币 -50, SAN +10</span>
                </button>
                <button class="action-btn life" data-action="bath">
                    <span class="action-icon">🚿</span>
                    <span class="action-name">去洗澡</span>
                    <span class="action-cost">SAN +8</span>
                </button>
                <button class="action-btn life special" data-action="love" id="btn-love" title="恋爱模块">
                    <span class="action-icon">❤️</span>
                    <span class="action-name">恋爱</span>
                    <span class="action-cost">解锁条件</span>
                </button>
                <button class="action-btn life special" data-action="date" id="btn-date" style="display: none;">
                    <span class="action-icon">💕</span>
                    <span class="action-name">约会</span>
                    <span class="action-cost">金币 -100, SAN +15</span>
                </button>
                <button class="action-btn life special" data-action="rest">
                    <span class="action-icon">😴</span>
                    <span class="action-name">休息</span>
                    <span class="action-cost">SAN +5</span>
                </button>
            </div>
        </div>
        
        <!-- 下一回合按钮：桌面端保留 -->
        <div class="turn-control desktop-only">
            <button id="btn-next-turn" class="btn btn-primary btn-large">
                结束本月 ▶
            </button>
        </div>

        <!-- 移动端结束本月按钮 -->
        <div class="mobile-only-block" style="margin: 10px; display: block;">
            <button id="btn-next-turn-mobile" class="btn btn-primary btn-large" style="width: 100%;">
                结束本月 ▶
            </button>
        </div>

        <!-- 事件日志 (桌面) -->
        <div class="event-log desktop-only" id="event-log">
            <h3>📋 事件记录</h3>
            <div class="log-content" id="log-content">
                <p class="log-entry">欢迎来到鲜椒！新的大学生活开始了...</p>
            </div>
        </div>

        <!-- 移除移动端底部导航栏 nav class="bottom-nav" -->
    </div>

    <!-- 选择弹窗 -->
    <div id="choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="choice-title">请选择</h3>
                <button class="modal-close" id="choice-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="choice-options" id="choice-options"></div>
            </div>
        </div>
    </div>

    <!-- 成就解锁弹窗 -->
    <div id="achievement-popup" class="achievement-popup">
        <div class="achievement-popup-content">
            <div class="achievement-icon">🏆</div>
            <div class="achievement-text">
                <span class="achievement-label">成就解锁！</span>
                <span class="achievement-name" id="achievement-name"></span>
            </div>
        </div>
    </div>

    <!-- 游戏菜单 -->
    <div id="game-menu" class="modal">
        <div class="modal-content menu-content">
            <h3>游戏菜单</h3>
            <div class="menu-buttons">
                <button id="btn-save" class="btn btn-secondary">💾 保存游戏</button>
                <button id="btn-view-achievements" class="btn btn-secondary">🏆 查看成就</button>
                <button id="btn-view-profile" class="btn btn-secondary">👤 个人经历</button>
                <button id="btn-settings" class="btn btn-secondary">⚙️ 游戏设置</button>
                <button id="btn-quit" class="btn btn-danger">🚪 退出游戏</button>
            </div>
            <button id="btn-close-menu" class="btn btn-primary">继续游戏</button>
        </div>
    </div>

    <!-- 考试弹窗 -->
    <div id="exam-modal" class="modal">
        <div class="modal-content exam-content">
            <div class="modal-header">
                <h3 class="modal-title">📝 期末考试</h3>
            </div>
            <div class="modal-body">
                <div class="exam-results" id="exam-results"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="exam-confirm">确认</button>
            </div>
        </div>
    </div>

    <!-- 补考选择弹窗 -->
    <div id="makeup-exam-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📋 挂科处理</h3>
            </div>
            <div class="modal-body">
                <p class="makeup-hint">
                    <strong>补考规则：</strong>只有专业课可以申请补考，补考通过按60分计入成绩。<br>
                    通识课、体育课及补考不通过的课程需要下学期重修。
                </p>
                <div class="makeup-courses" id="makeup-courses"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="makeup-confirm">确认</button>
            </div>
        </div>
    </div>

    <!-- 补考进行弹窗 -->
    <div id="makeup-exam-result-modal" class="modal">
        <div class="modal-content exam-content">
            <div class="modal-header">
                <h3 class="modal-title">📝 补考结果</h3>
            </div>
            <div class="modal-body">
                <div class="exam-results" id="makeup-exam-results"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="makeup-result-confirm">确认</button>
            </div>
        </div>
    </div>

    <!-- 选课博弈弹窗 -->
    <div id="course-bidding-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">📋 选课系统开放</h3>
            </div>
            <div class="modal-body">
                <p class="bidding-desc">新学期选课开始！你有 <strong>100</strong> 权重分需要分配给三类课程。</p>
                <div class="bidding-pools">
                    <div class="bidding-pool">
                        <div class="pool-header">
                            <span class="pool-icon">🌊</span>
                            <span class="pool-name">水课池</span>
                        </div>
                        <div class="pool-desc">难度低，GPA提升快</div>
                        <input type="range" id="weight-easy" min="0" max="100" value="34" class="weight-slider" oninput="game.updateBiddingTotal()">
                        <span class="weight-value">34</span>
                    </div>
                    <div class="bidding-pool">
                        <div class="pool-header">
                            <span class="pool-icon">💪</span>
                            <span class="pool-name">硬课池</span>
                        </div>
                        <div class="pool-desc">难度高，科研/技能提升多</div>
                        <input type="range" id="weight-hard" min="0" max="100" value="33" class="weight-slider" oninput="game.updateBiddingTotal()">
                        <span class="weight-value">33</span>
                    </div>
                    <div class="bidding-pool">
                        <div class="pool-header">
                            <span class="pool-icon">🎨</span>
                            <span class="pool-name">兴趣课池</span>
                        </div>
                        <div class="pool-desc">SAN值恢复快，轻松愉快</div>
                        <input type="range" id="weight-interest" min="0" max="100" value="33" class="weight-slider" oninput="game.updateBiddingTotal()">
                        <span class="weight-value">33</span>
                    </div>
                </div>
                <div class="weight-total">当前总权重: <span id="total-weight">100</span>/100</div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="confirm-bidding">确认选课</button>
            </div>
        </div>
    </div>

    <!-- 体测弹窗 -->
    <div id="physical-test-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🏃 体测月来临！</h3>
            </div>
            <div class="modal-body">
                <p id="physical-test-desc">又到了体测的时候...</p>
                <div class="physical-test-status" id="physical-test-status">
                    <div class="test-item">
                        <span class="test-label">体力上限</span>
                        <span class="test-value" id="test-stamina-value">10/12</span>
                        <span class="test-result" id="test-stamina-result">❌</span>
                    </div>
                    <div class="test-item">
                        <span class="test-label">本月跑步次数</span>
                        <span class="test-value" id="test-run-value">0/3</span>
                        <span class="test-result" id="test-run-result">❌</span>
                    </div>
                </div>
                <div class="test-warning" id="test-warning" style="display: none;">
                    ⚠️ 体测不达标将扣除综测分并影响SAN值！
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="physical-test-confirm">确认</button>
            </div>
        </div>
    </div>

    <!-- 长远规划选择弹窗 -->
    <div id="career-choice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">🎯 选择你的未来方向</h3>
            </div>
            <div class="modal-body">
                <p>大三下学期了，是时候规划未来了。请选择一个方向：</p>
                <div class="career-choices">
                    <button class="career-choice-btn" data-career="postgrad">
                        <div class="career-icon">🎓</div>
                        <div class="career-name">保研深造</div>
                        <div class="career-desc">找导师、大创项目、竞赛加分</div>
                    </button>
                    <button class="career-choice-btn" data-career="abroad">
                        <div class="career-icon">✈️</div>
                        <div class="career-name">出国留学</div>
                        <div class="career-desc">托福/GRE、申请材料、金币消耗翻倍</div>
                    </button>
                    <button class="career-choice-btn" data-career="job">
                        <div class="career-icon">💼</div>
                        <div class="career-name">就业工作</div>
                        <div class="career-desc">实习、面试、金币增加、Mastery变慢</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 小学期弹窗 -->
    <div id="summer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">☀️ 小学期来临！</h3>
            </div>
            <div class="modal-body">
                <p id="summer-desc">七月炎炎，小学期开始了！</p>
                <div class="summer-options" id="summer-options"></div>
            </div>
        </div>
    </div>

    <!-- 月末随机事件弹窗 -->
    <div id="random-event-modal" class="modal">
        <div class="modal-content random-event-content">
            <div class="event-header">
                <div class="event-icon-large" id="random-event-icon">📦</div>
                <h3 class="event-title" id="random-event-title">事件标题</h3>
            </div>
            <div class="event-body">
                <p class="event-description" id="random-event-desc">事件描述...</p>
                <div class="event-options" id="random-event-options">
                    <!-- 动态生成选项 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 事件结果弹窗 -->
    <div id="event-result-modal" class="modal">
        <div class="modal-content event-result-content">
            <div class="result-icon" id="result-icon">✨</div>
            <div class="result-message" id="result-message">结果消息</div>
            <div class="result-effects" id="result-effects">
                <!-- 效果变化 -->
            </div>
            <button class="btn btn-primary" id="result-confirm">确定</button>
        </div>
    </div>

    <!-- 脚本引入 -->
    <!-- 设置 Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">AI 设置</h3>
                <button class="modal-close" id="settings-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">API 接入</label>
                    <div style="padding: 10px; background: #f0f7ff; border-radius: 4px; border-left: 4px solid #003E7E; font-size: 0.9rem; margin-bottom: 15px;">
                        当前使用: <strong>鲜椒 AI Proxy</strong><br>
                        无需翻墙，支持 DeepSeek 模型。
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">API Key</label>
                    <input type="password" id="setting-api-key" placeholder="请输入你的 API Key" style="width:100%; padding:8px; border-radius:4px; border:1px solid #ccc; margin-bottom: 10px;">
                    <button class="btn btn-primary" id="test-api-key" style="width:100%; padding:8px; background:#003E7E; color:white; border:none; border-radius:4px; cursor:pointer;">应用密钥</button>
                    <p id="api-test-result" style="font-size:0.9rem; margin-top:10px; padding:8px; border-radius:4px; display:none;"></p>
                    <p style="font-size:0.8rem; color:#666; margin-top:10px;">
                        * Key 仅存储在本地浏览器中，不会上传服务器。<br>
                        * 可以在本地 config.js 中配置，也可以在此处输入。
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="settings-close-btn">关闭</button>
            </div>
        </div>
    </div>

    <!-- 鲜椒生存手册弹窗 -->
    <div id="survival-handbook-modal" class="modal">
        <div class="modal-content handbook-modal" style="max-height: 90vh; overflow-y: auto; max-width: 900px;">
            <div class="modal-header" style="background: linear-gradient(135deg, #003E7E 0%, #1a5f9f 100%); color: white; border-radius: 16px 16px 0 0; padding: 28px; border: none;">
                <h2 class="modal-title" style="display: flex; align-items: center; gap: 12px; color: white; font-size: 1.8rem; margin: 0;">
                    <span style="font-size: 2.2rem;">📖</span>
                    <span>鲜椒生存手册</span>
                </h2>
                <button class="modal-close" id="handbook-close" style="color: white; opacity: 0.9; font-size: 2rem;">&times;</button>
            </div>
            <div class="modal-body handbook-body" style="padding: 0;">
                <!-- 核心理念 -->
                <div class="handbook-philosophy">
                    <div class="philosophy-icon">🎮</div>
                    <h2 class="philosophy-title">体验没有试错成本的另一种人生</h2>
                    <p class="philosophy-text">
                        在这里，你可以大胆尝试任何选择。挂科了？重来。社交废了？重来。<br>
                        这不是教你"正确答案"，而是让你看到：<strong>大学生活不是只有一种选择</strong>。
                    </p>
                    <div class="philosophy-tags">
                        <span class="tag">🔄 随时重来</span>
                        <span class="tag">🌈 多种路径</span>
                        <span class="tag">💯 每个选择都有价值</span>
                    </div>
                </div>

                <!-- 游戏玩法 -->
                <div class="handbook-gameplay-section">
                    <h2 class="section-heading">🎯 游戏玩法</h2>
                    <div class="gameplay-grid">
                        <div class="gameplay-item">
                            <div class="gameplay-icon">📅</div>
                            <h3>四年时光</h3>
                            <p>从大一到大四，共48个月<br>每个月选择行动，塑造你的大学</p>
                        </div>
                        <div class="gameplay-item">
                            <div class="gameplay-icon">⚖️</div>
                            <h3>平衡管理</h3>
                            <p>学业、SAN值、金币、社交...<br>在各种数值间找到你的节奏</p>
                        </div>
                        <div class="gameplay-item">
                            <div class="gameplay-icon">🎲</div>
                            <h3>随机事件</h3>
                            <p>100+个事件等待触发<br>每次游戏都有新的惊喜</p>
                        </div>
                        <div class="gameplay-item">
                            <div class="gameplay-icon">🏆</div>
                            <h3>成就收集</h3>
                            <p>110+个成就等你解锁<br>探索不同的玩法和选择</p>
                        </div>
                    </div>
                </div>

                <!-- 结局展示 -->
                <div class="handbook-endings-section">
                    <h2 class="section-heading">🎓 五种结局，五种人生</h2>
                    <p class="section-subtitle">没有"好坏"之分，只有不同的选择和收获</p>
                    <div class="endings-showcase">
                        <div class="ending-showcase-card fail">
                            <div class="ending-badge">😢</div>
                            <h3>肄业</h3>
                            <p class="ending-condition">GPA < 2.0 或 SAN ≤ 0</p>
                            <p class="ending-message">失败也是一种体验。<br>现实中的你，会更懂得平衡。</p>
                        </div>
                        <div class="ending-showcase-card normal">
                            <div class="ending-badge">🎓</div>
                            <h3>普通毕业</h3>
                            <p class="ending-condition">GPA ≥ 2.0</p>
                            <p class="ending-message">平凡而真实的大学生活。<br>这才是大多数人的常态。</p>
                        </div>
                        <div class="ending-showcase-card good">
                            <div class="ending-badge">📚</div>
                            <h3>保研成功</h3>
                            <p class="ending-condition">GPA ≥ 3.5 + 综测 ≥ 80</p>
                            <p class="ending-message">学术道路继续延伸。<br>努力总会有回报。</p>
                        </div>
                        <div class="ending-showcase-card excellent">
                            <div class="ending-badge">🏆</div>
                            <h3>优秀毕业生</h3>
                            <p class="ending-condition">GPA ≥ 4.0 + 综测 ≥ 95 + 国奖</p>
                            <p class="ending-message">接近完美的表现。<br>但代价是什么？</p>
                        </div>
                        <div class="ending-showcase-card hidden">
                            <div class="ending-badge">🚀</div>
                            <h3>西迁精神传承者</h3>
                            <p class="ending-condition">特殊剧情触发</p>
                            <p class="ending-message">在游戏中寻找"西部"主题。<br>这是一条不被数值定义的路。</p>
                        </div>
                    </div>
                </div>

                <!-- 游戏特色 -->
                <div class="handbook-features-section">
                    <h2 class="section-heading">✨ 游戏特色</h2>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">🏆</div>
                            <h3>110+ 成就系统</h3>
                            <ul class="feature-list">
                                <li>🎯 学业成就：从"门门挂科"到"全A学霸"</li>
                                <li>💕 社交成就：从"社恐"到"人脉王"</li>
                                <li>🎨 特殊成就：隐藏的惊喜等你发现</li>
                            </ul>
                            <p class="feature-note">每个成就都代表一种人生体验</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎭</div>
                            <h3>9个书院，9种模式</h3>
                            <ul class="feature-list">
                                <li>🔬 钱学森：高难度学霸挑战</li>
                                <li>🎨 崇实：社交型人生</li>
                                <li>⚕️ 宗濂：医学生的独特体验</li>
                            </ul>
                            <p class="feature-note">每个书院都有独特的玩法和加成</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔀</div>
                            <h3>多重路径选择</h3>
                            <ul class="feature-list">
                                <li>📚 保研深造：学术路线</li>
                                <li>✈️ 出国留学：国际化路线</li>
                                <li>💼 直接就业：实用主义路线</li>
                            </ul>
                            <p class="feature-note">大三下需要做出你的选择</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎲</div>
                            <h3>无限重玩性</h3>
                            <ul class="feature-list">
                                <li>📖 100+ 随机事件</li>
                                <li>💕 恋爱系统（可选）</li>
                                <li>🌟 声望系统与隐藏剧情</li>
                            </ul>
                            <p class="feature-note">每次游戏都有不同的体验</p>
                        </div>
                    </div>
                </div>

                <!-- 最后的话 -->
                <div class="handbook-farewell">
                    <div class="farewell-icon-large">🌟</div>
                    <h2>没有标准答案的人生</h2>
                    <p>
                        也许你会保研成功，也许你会挂科重修。<br>
                        也许你会恋爱脱单，也许你会孤独前行。<br>
                        也许你会成为学霸，也许你会选择佛系。<br><br>
                        <strong>这些都是真实的大学，这些都是可能的人生。</strong><br><br>
                        在这个游戏里，试错不需要成本。<br>
                        所以，大胆去试吧。😊
                    </p>
                </div>
            </div>
            <div class="modal-footer" style="justify-content: center; padding: 24px; border-top: 1px solid #e6e6e6; background: linear-gradient(to top, #f9f9f9, white);">
                <button class="btn btn-primary" id="handbook-confirm" style="background: linear-gradient(135deg, #003E7E, #1a5f9f); border: none; padding: 14px 48px; font-size: 1.1rem; border-radius: 30px; box-shadow: 0 4px 16px rgba(0,62,126,0.3); font-weight: 600; letter-spacing: 1px;">开始你的大学生活 🎓</button>
            </div>
        </div>
    </div>

    <!-- 通用信息弹窗 (用于 showMessage) -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">提示</h3>
                <button class="modal-close" onclick="document.getElementById('modal').classList.remove('active')">&times;</button>
            </div>
            <div class="modal-body" id="modal-body"></div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="modal-confirm" onclick="document.getElementById('modal').classList.remove('active')">确定</button>
            </div>
        </div>
    </div>

    <!-- 移动端日志详情弹窗 -->
    <div id="mobile-log-modal" class="modal">
        <div class="modal-content" style="max-height: 80vh; display: flex; flex-direction: column;">
             <div class="modal-header">
                <h3 class="modal-title">📜 事件记录</h3>
                <button class="modal-close mobile-log-close">&times;</button>
            </div>
            <div class="modal-body" id="mobile-log-body" style="flex: 1; overflow-y: auto; padding: 15px;">
                <!-- Logs copied here -->
            </div>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script src="js/config.js"></script>
    <script src="js/ai_module.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/events.js"></script>
    <script src="js/game.js"></script>
</body>
</html>
